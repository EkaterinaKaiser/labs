## Лаборатория Suricata IPS (victim / attacker)

### Локальный запуск

- **Запуск контейнеров**
  ```bash
  docker compose up -d
  ```

- **Установка и запуск Suricata в режиме IPS на хосте**
  ```bash
  chmod +x setup-suricata.sh
  sudo ./setup-suricata.sh
  ```

### Автоматическая установка в облаке (GitHub Actions)

Workflow `.github/workflows/main.yml` умеет автоматически устанавливать лабораторию на удалённый облачный хост по SSH после успешного прохождения тестов.

- **Требования к облачному хосту**
  - Установлены: `docker`, `docker compose`, `git`, `sudo`.
  - Пользователь, под которым будет выполняться деплой, имеет доступ по SSH и права `sudo` без пароля (или настроен соответствующим образом).

- **Необходимые GitHub Secrets**
  Создайте в настройках репозитория (`Settings → Secrets and variables → Actions`) следующие секреты:

  - **`CLOUD_HOST`**: IP или DNS-имя облачного сервера (например, `203.0.113.10`).
  - **`CLOUD_USER`**: SSH‑пользователь для подключения к серверу (например, `ubuntu`).
  - **`CLOUD_SSH_KEY`**: приватный SSH‑ключ в формате PEM, соответствующий открытому ключу, добавленному в `~/.ssh/authorized_keys` на сервере.
  - **`CLOUD_WORKDIR`** (опционально): каталог на сервере, куда будет клонироваться репозиторий (по умолчанию `labs`).

- **Что делает деплой‑job `deploy-cloud`**
  - Подключается к облачному хосту по SSH с использованием `CLOUD_SSH_KEY`.
  - Клонирует (при первом запуске) или обновляет репозиторий в каталоге `CLOUD_WORKDIR`.
  - Запускает на сервере скрипт `setup-suricata.sh` для установки и настройки Suricata в режиме IPS.
  - Запускает лабораторные контейнеры командой `docker compose up -d`.

Job `deploy-cloud` запускается автоматически при пуше в ветку `main` и выполняется только после успешного завершения тестового job `test-lab`.